if (clima$dir[i] == ""){
print(clima$dir[i])
}
}
clima
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
load("./WUndergroundHourly.RData")
# Remove all coloumns without data (only NA columns)
clima <- select(WG,!c("wind_gust","wind_chill","heat_index","precip","precip_rate","precip_total"))
# Remove columns with fixed values
clima <- select(clima, !c("hail","thunder","tornado"))
#formatting data
clima[c('date','time')] <- str_split_fixed(clima$date,' ',2)
# Picking the correct datatype for the columns
clima <- mutate(clima,
dir  = factor(dir),
cond = factor(cond),
fog  = factor(fog),
rain = factor(rain),
snow = factor(snow),
date = factor(date),
time = factor(time)
)
clima_by_date <- group_by(clima, date)
summarise(clima_by_date, mean(temp))
summarise(clima_by_date, mean(temp), mode(dir))
summarise(clima_by_date, mean(temp), mean(dir))
summarise(clima_by_date, mean(temp, na.rm = T), mean(dir))
summarise(clima_by_date, mean(temp, na.rm = T), Mode(dir))
summarise(clima_by_date,
mean(temp, na.rm = T),
mean(dew_pt, na.rm = T),
mean(hum, na.rm = T),
mean(wind_spd, na.rm = T),
mean(vis, na.rm = T),
mean(pressure, na.rm = T))
distinct(clima$date)
levels(clima$date)
all_dates[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
all_dates[i]
}
print(all_dates[i])
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
print(all_dates[i])
}
print(all_factor)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
all_factor <- select(clima$all_dates[i], dir)
print(all_factor)
}
print(date)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date = all_dates[i])
print(date)
}
date <- filter(clima, date = all_dates[1])
date <- filter(clima, date == all_dates[i])
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i])
print(date)
}
getmode <- function(v) {
groupv <- unique(v)
tab <- tabulate(match(v,groupv))
groupv[tab == max(tab)]
}
levels(clima$date)
getmode(date)
getmode(date)
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
getmode(date)
}
getmode(date)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
getmode(date)
}
getmode()
summarise(clima)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
load("./WUndergroundHourly.RData")
# Remove all coloumns without data (only NA columns)
clima <- select(WG,!c("wind_gust","wind_chill","heat_index","precip","precip_rate","precip_total"))
# Remove columns with fixed values
clima <- select(clima, !c("hail","thunder","tornado"))
#formatting data
clima[c('date','time')] <- str_split_fixed(clima$date,' ',2)
# Picking the correct datatype for the columns
clima <- mutate(clima,
dir  = factor(dir),
cond = factor(cond),
fog  = factor(fog),
rain = factor(rain),
snow = factor(snow),
date = factor(date),
time = factor(time)
)
clima_by_date <- group_by(clima, date)
summarise(clima_by_date,
mean(temp, na.rm = T),
mean(dew_pt, na.rm = T),
mean(hum, na.rm = T),
mean(wind_spd, na.rm = T),
mean(vis, na.rm = T),
mean(pressure, na.rm = T))
summarise(clima)
WG
# Remove all coloumns without data (only NA columns)
clima <- select(WG,!c("wind_gust","wind_chill","heat_index","precip","precip_rate","precip_total"))
# Remove columns with fixed values
clima <- select(clima, !c("hail","thunder","tornado"))
#formatting data
clima[c('date','time')] <- str_split_fixed(clima$date,' ',2)
# Picking the correct datatype for the columns
clima <- mutate(clima,
dir  = factor(dir),
cond = factor(cond),
fog  = factor(fog),
rain = factor(rain),
snow = factor(snow),
date = factor(date),
time = factor(time)
)
summarise(clima)
# Picking the correct datatype for the columns
clima <- mutate(clima,
dir  = factor(dir),
cond = factor(cond),
fog  = factor(fog),
rain = factor(rain),
snow = factor(snow),
date = factor(date),
time = factor(time)
)
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
load("./WUndergroundHourly.RData")
# Remove all coloumns without data (only NA columns)
clima <- select(WG,!c("wind_gust","wind_chill","heat_index","precip","precip_rate","precip_total"))
# Remove columns with fixed values
clima <- select(clima, !c("hail","thunder","tornado"))
#formatting data
clima[c('date','time')] <- str_split_fixed(clima$date,' ',2)
# Picking the correct datatype for the columns
clima <- mutate(clima,
dir  = factor(dir),
cond = factor(cond),
fog  = factor(fog),
rain = factor(rain),
snow = factor(snow),
date = factor(date),
time = factor(time)
)
clima_by_date <- group_by(clima, date)
summarise(clima_by_date,
mean(temp, na.rm = T),
mean(dew_pt, na.rm = T),
mean(hum, na.rm = T),
mean(wind_spd, na.rm = T),
mean(vis, na.rm = T),
mean(pressure, na.rm = T))
clima
summarise(clima)
summary(clima)
quantile(clima$dir)
Mode(clima$dir)
table(clima$dir)
max(table(clima$dir))
clima$dir == max(table(clima$dir))
clima$dir[clima$dir == max(table(clima$dir))]
max(table(clima$dir))
table(clima$dir)[clima$dir == max(table(clima$dir))]
max(table(clima$dir))
table(clima$dir)
getmode(clima$dir)
groupv[tab == max(tab)]
getmode <- function(v) {
groupv <- unique(v)
tab <- tabulate(match(v,groupv))
groupv[tab == max(tab)]
}
groupv[tab == max(tab)]
getmode(clima$dir)
getmode(clima$dir)
getmode(clima$dir)[1]
getmode(clima$dir)[2]
getmode(clima$dir)[1]
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
print(date)
}
getmode <- function(v) {
groupv <- unique(v)
tab <- tabulate(match(v,groupv))
groupv[tab == max(tab)]
}
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
print(
}
getmode <- function(v) {
groupv <- unique(v)
tab <- tabulate(match(v,groupv))
groupv[tab == max(tab)]
}
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
print(date)
}
getmode(date)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
getmode(date)
}
getmode(date)
getmode(clima$dir)
getmode(clima$dir)
as.data.frame(getmode(clima$dir))
as.data.frame(getmode(clima$dir))[[1]]
as.data.frame(getmode(clima$dir))[[1]]
y <- as.data.frame(getmode(clima$dir))[[1]]
y
y <- as.data.frame(getmode(clima$dir))[1][1]
y
y <- as.data.frame(getmode(clima$dir))
date
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
date
}
date
count(date)
max(date)
table(date)
count(date)
table(date)
max(table(date))
max(count_table)
for (i in 1:1){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
count_table <- table(date)
max(count_table)
}
max(count_table)
count_table[count_table == max(count_table)]
max <- row.names(max_only)
max_only <- count_table[count_table == max(count_table)]
max <- row.names(max_only)
max
row.names(max_only)
row.names(max_only)
row.names(max_only)
max_only
as.data.frame(max_only)
as.data.frame(max_only)[1,1]
as.matrix(max_only)[1,1]
as.matrix(max_only)[[1]]
colnames(max_only)
colnames(as.data.frame(max_only))
rownames(as.data.frame(max_only))
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
count_table <- table(date)
max_only <- count_table[count_table == max(count_table)]
rownames(as.data.frame(max_only))
}
count_table <- table(date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
count_table <- table(date)
max_only <- count_table[count_table == max(count_table)]
rownames(as.data.frame(max_only))
}
rownames(as.data.frame(max_only))
rownames(as.data.frame(max_only))
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
count_table <- table(date)
max_only <- count_table[count_table == max(count_table)]
rownames(as.data.frame(max_only))
}
rownames(as.data.frame(max_only))
print(rownames(as.data.frame(max_only)))
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
count_table <- table(date)
max_only <- count_table[count_table == max(count_table)]
print(rownames(as.data.frame(max_only)))
}
summarise(date)
summarise(date)
summarise(date)
summarise(date)
date <- filter(clima, date == all_dates[i])
summarise(date)
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i])
summarise(date)
summarise(date)
summarise(date)
summarise(date)
print(summarise(date))
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i])
print(summarise(date))
}
print(summarise(date))
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i])
print(summarise(date))
}
date
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
date
}
date
date[[1]]
a <- c("a","a","b")
table(a)
a <- c("a","a","b")
table(a)
a <- c("a","a","b","c")
table(a)
table(a)
which.max(table(a))
which.max(table(a))
which.max(table(a))
rowname(which.max(table(a)))
rownames(which.max(table(a)))
rownames(as.data.frame(which.max(table(a))))
rownames(as.data.frame(which.max(table(date))))
factor = "dir"
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
rownames(as.data.frame(which.max(table(date))))
}
rownames(as.data.frame(which.max(table(date))))
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
rownames(as.data.frame(which.max(table(date))))
}
print(max)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
}
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
}
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
}
# Assign the modes of all
all_factors = c("dir","cond","fog")
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
for (i in 1:length(all_dates)){
date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(date))))
print(max)
}
}
clima_by_date
clima_by_date <- group_by(clima, date)
summarise(clima_by_date,
mean(temp, na.rm = T),
mean(dew_pt, na.rm = T),
mean(hum, na.rm = T),
mean(wind_spd, na.rm = T),
mean(vis, na.rm = T),
mean(pressure, na.rm = T))
clima
clima_by_date
print(put_in_date)
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
put_in_date <- c()
for (i in 1:length(all_dates)){
factor_for_date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(factor_for_date))))
put_in_date <- c(put_in_date,max)
}
print(put_in_date)
}
clima_by_date$factor <- put_in_date
all_factors <- mutate(all_factors, factor = put_in_date )
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
put_in_date <- c()
for (i in 1:length(all_dates)){
factor_for_date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(factor_for_date))))
put_in_date <- c(put_in_date,max)
}
all_factors <- mutate(all_factors, factor = put_in_date )
}
all_factors <- mutate(all_factors, factor = as.data.frame(put_in_date) )
for (i in 1:length(all_factors)){
factor = all_factors[i]
all_dates <- levels(clima$date)
put_in_date <- c()
for (i in 1:length(all_dates)){
factor_for_date <- filter(clima, date == all_dates[i]) %>%
select(factor)
max <- rownames(as.data.frame(which.max(table(factor_for_date))))
put_in_date <- c(put_in_date,max)
}
all_factors <- mutate(all_factors, factor = as.data.frame(put_in_date) )
}
print(put_in_date)
clima_by_date
