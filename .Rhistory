#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
setwd("~/GitHub/Projekt2_statestik")
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
as.POSIXct(D$date, tz = "UTC")
D$Date <- as.POSIXct(D$date)
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
# Removing outliers
D1 <- D[!(row.names(D) %in% c(3357, 3282, 3440, 8946, 4682, 7112, 1460, 8266, 4375, 2533, 2535, 7478, 7178, 87, 1)),]
par(mfrow=c(2,2))
lm_max <- lm(consumption ~ tempdif+ID+dew_pt+hum+wind_spd+pressure, data=D1)
par(mfrow=c(1,1))
plot(lm_max)
par(mfrow=c(2,2))
lm_max <- lm(consumption ~ tempdif+ID+dew_pt+hum+wind_spd+pressure, data=D1)
plot(lm_max)
lm_max1 <- step((lm_max), scope = ~.^2, k=log(nrow(D1), test="F")
lm_max1 <- step((lm_max), scope = ~.^2, k=log(nrow(D1)), test="F")
Anova(lm_max1)
step(lm3, scope = ~.^2, k=log(nrow(D1)), test="F")
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# Removing outliers
D1 <- D[!(row.names(D) %in% c(3357, 3282, 3440, 8946, 4682, 7112, 1460, 8266, 4375, 2533, 2535, 7478, 7178, 87, 1)),]
#### Analysis Model ####
par(mfrow=c(1,1))
lm1 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D )
plot(lm1) # looks not very good
lm3 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
D2 <- D1[!(row.names(D1) %in% c(3357,3282,7178,8829,9440,7082,7112,7081,8859)),]
lm3 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm3)
D2 <- D1[!(row.names(D1) %in% c(3357,3282,7178,8829,9440,7082,7112,7081,8859, 9453, 4, 97)),]
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm4)
step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
Anova(lm4_step)
D <- select(WG,!c("temp"))
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
D <- select(D,!c("temp"))
lm2 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D1 )
plot(lm2) # looks not very good
D1 <- D[!(row.names(D) %in% c(3357,3282,7178,8829)),]
lm2 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D1 )
plot(lm2) # looks not very good
D1 <- D[!(row.names(D) %in% c(3357,3282,7178,8829)),]
lm2 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D1 )
plot(lm2) # looks not very good
plot(lm4)
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
D2 <- D1[!(row.names(D1) %in% c(3357,3282,7178,8829,9440,7082,7112,7081,8859, 9453, 4, 97)),]
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm4)
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
Anova(lm4_step)
Anova(lm4_step)
summary(lm4_step)
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
D <- select(D,!c("temp"))
#### Analysis Model ####
par(mfrow=c(1,1))
lm1 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D )
plot(lm1) # looks not very good
lm3 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm3)
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm4)
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
summary(lm4_step)
#### Analysis Model ####
par(mfrow=c(1,1))
lm1 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D )
plot(lm1) # looks not very good
D2 <- D1[!(row.names(D1) %in% c(3357,3282,7178,8829,9440,7082,7112,7081,8859, 9453, 4, 97)),]
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm4)
D1 <- D[!(row.names(D) %in% c(3357,3282,7178,8829)),]
D2 <- D1[!(row.names(D1) %in% c(3357,3282,7178,8829,9440,7082,7112,7081,8859, 9453, 4, 97)),]
lm4 <- lm(consumption ~ . - date - dir - vis -cond - fog -rain, data=D2 )
plot(lm4)
lm4_step <- step(lm4, scope = ~.^2, k=log(nrow(D1)), test="F")
Anova(lm4_step)
Aic(lm4_step)
aic(lm4_step)
AIC(lm4_step)
AIC(lm(formula = std_cons ~ ID + dew_pt + hum + wind_spd + tempdif +
ID:tempdif + wind_spd:tempdif + dew_pt:tempdif, data = D_scope))
AIC(lm(formula = std_cons ~ ID + dew_pt + hum + wind_spd + tempdif +
ID:tempdif + wind_spd:tempdif + dew_pt:tempdif, data = D2))
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Minimum model
mean_cons<- mean(D$consumption)
D <- mutate(date, std_cons=consumption/mean_cons)
D_no_clima <- select(D, ID,start_or_end, tempdif, std_cons)
fit <- lm(std_cons ~ .^4, D_no_clima)
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
AIC(new_fit)
# Looking for outliers
par(mfrow=c(2,2))
plot(new_fit)
# Removing outliers
remove <- c(3357,3282,3440)
D <- D[!(row.names(D) %in% remove ),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% remove),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
# adding some clima
fit_clima <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F")
fit <- lm(std_cons ~ .^2, D_no_clima)
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
AIC(new_fit)
fit <- lm(std_cons ~ .^2, D_no_clima, k=log(nrow(D)))
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
AIC(new_fit)
# Looking for outliers
par(mfrow=c(2,2))
plot(new_fit)
# Removing outliers
remove <- c(3357,3282,3440)
D <- D[!(row.names(D) %in% remove ),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% remove),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
fit4 <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
fit2 <- lm(std_cons ~ (ID + start_or_end + tempdif)^2, D_no_clima)
AIC(fit4, fit2)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
# adding some clima
fit_clima <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F")
anova(fit_clima, fit) # They are sig dif
AIC(fit_clima, fit) # fit_clima er bedre
Anova(fit_clima)
plot(fit_clima)
# adding some clima
fit_clima <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F", scope = ~.^2)
anova(fit_clima, fit) # They are sig dif
AIC(fit_clima, fit) # fit_clima er bedre
plot(fit_clima)
