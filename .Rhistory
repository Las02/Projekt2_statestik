#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
setwd("~/GitHub/Projekt2_statestik")
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
as.POSIXct(D$date, tz = "UTC")
D$Date <- as.POSIXct(D$date)
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
# Removing outliers
D1 <- D[!(row.names(D) %in% c(3357, 3282, 3440, 8946, 4682, 7112, 1460, 8266, 4375, 2533, 2535, 7478, 7178, 87, 1)),]
par(mfrow=c(2,2))
lm_max <- lm(consumption ~ tempdif+ID+dew_pt+hum+wind_spd+pressure, data=D1)
par(mfrow=c(1,1))
plot(lm_max)
par(mfrow=c(2,2))
lm_max <- lm(consumption ~ tempdif+ID+dew_pt+hum+wind_spd+pressure, data=D1)
plot(lm_max)
lm_max1 <- step((lm_max), scope = ~.^2, k=log(nrow(D1), test="F")
lm_max1 <- step((lm_max), scope = ~.^2, k=log(nrow(D1)), test="F")
Anova(lm_max1)
