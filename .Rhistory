D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Creating initalizing plots ####
# Pairplot of all variables
#plot(D,col=D$ID,main="Pairsplot of dataframe")
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# shows date needs to be factorized in some sort of way
# Consumption as a function of hum
#plot(D$consumption ~ D$hum, col=D$ID, main = "Consumption as a function of humidity")
# Box plot af consumption as a function of ID
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID")
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID",ylim=c(0,1))
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Trying one fit
it <- lm(consumption~tempdif+ID+tempdif:start_or_end,date)
Anova(fit)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Creating initalizing plots ####
# Pairplot of all variables
#plot(D,col=D$ID,main="Pairsplot of dataframe")
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# shows date needs to be factorized in some sort of way
# Consumption as a function of hum
#plot(D$consumption ~ D$hum, col=D$ID, main = "Consumption as a function of humidity")
# Box plot af consumption as a function of ID
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID")
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID",ylim=c(0,1))
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Trying one fit
it <- lm(consumption~tempdif+ID+tempdif:start_or_end,date)
Anova(fit)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Creating initalizing plots ####
# Pairplot of all variables
#plot(D,col=D$ID,main="Pairsplot of dataframe")
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# shows date needs to be factorized in some sort of way
# Consumption as a function of hum
#plot(D$consumption ~ D$hum, col=D$ID, main = "Consumption as a function of humidity")
# Box plot af consumption as a function of ID
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID")
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID",ylim=c(0,1))
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Trying one fit
#it <- lm(consumption~tempdif+ID+tempdif:start_or_end,date)
#Anova(fit)
#coplot(consumption ~ tempdif | start_or_end,date,col=date$ID)
# And another
#fit <- lm(consumption~tempdif+ID+tempdif:start_or_end +ID:tempdif:start_or_end,date)
#par(mfrow=c(2,2))
#plot(fit)
# Minimum model
mean_cons<- mean(D$consumption)
D <- mutate(date, std_cons=consumption/mean_cons)
D_no_clima <- select(D, ID,start_or_end, tempdif, std_cons)
fit <- lm(std_cons ~ .^4, D_no_clima)
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
# Looking for outliers
par(mfrow=c(2,2))
plot(new_fit)
# Removing outliers
D <- D[!(row.names(D) %in% c(3357,3282)),]
D_no_clima <- select(D, ID,start_or_end, tempdif, std_cons)
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(new_fit)
summary(new_fit)
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% c(3357,3282)),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(new_fit)
summary(new_fit)
D[!(row.names(D) %in% c(3357,3282)),]
nrow(D[!(row.names(D) %in% c(3357,3282)),])
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Creating initalizing plots ####
# Pairplot of all variables
#plot(D,col=D$ID,main="Pairsplot of dataframe")
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# shows date needs to be factorized in some sort of way
# Consumption as a function of hum
#plot(D$consumption ~ D$hum, col=D$ID, main = "Consumption as a function of humidity")
# Box plot af consumption as a function of ID
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID")
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID",ylim=c(0,1))
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Trying one fit
#it <- lm(consumption~tempdif+ID+tempdif:start_or_end,date)
#Anova(fit)
#coplot(consumption ~ tempdif | start_or_end,date,col=date$ID)
# And another
#fit <- lm(consumption~tempdif+ID+tempdif:start_or_end +ID:tempdif:start_or_end,date)
#par(mfrow=c(2,2))
#plot(fit)
# Minimum model
mean_cons<- mean(D$consumption)
D <- mutate(date, std_cons=consumption/mean_cons)
D_no_clima <- select(D, ID,start_or_end, tempdif, std_cons)
fit <- lm(std_cons ~ .^4, D_no_clima)
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
# Looking for outliers
par(mfrow=c(2,2))
plot(new_fit)
nrow(D)
D[!(row.names(D) %in% c(3357,3282)),]
nrow( D[!(row.names(D) %in% c(3357,3282)),])
nrow(D)
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(new_fit)
summary(new_fit)
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
# Removing outliers
D <- D[!(row.names(D) %in% c(3357,3282)),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% c(3357,3282)),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
# Removing outliers
D <- D[!(row.names(D) %in% c(3357,3282,3440)),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% c(3357,3282)),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
# Removing outliers
remove <- c(3357,3282,3440)
# Removing outliers
remove <- c(3357,3282,3440)
ve <- c(3357,3282,3440)
# Removing outliers
remove <- c(3357,3282,3440)
D <- D[!(row.names(D) %in% remove ),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% remove),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
f <- update(fit, .~. + D$wind_spd + D$wind_spd:D$wind_spd)
Anova(f)
Anova(f)
Anova(f)
# Adding clima to the party
f <- update(fit, .~. + D$wind_spd + D$wind_spd:D$dir)
Anova(f)
# Adding clima to the party
f <- update(fit, .~. + D$wind_spd*D$dir)
Anova(f)
f <- update(fit, .~. + D$fog)
Anova(f)
# Adding clima to the party
f <- update(fit, .~. + D$wind_spd*D$dir)
Anova(f)
# Fog i not significant
f <- update(f, .~. + D$fog*D$wind_spd)
Anova(f)
f <- update(f, .~. -D$fog:D$wind_spd)
Anova(f)
# Rain
f <- update(f, .~. -D$rain)
Anova(f)
# Rain
f <- update(f, .~. +D$rain)
Anova(f)
#
f <- update(f, .~. +D$vis)
Anova(f)
f <- update(f, .~. D$rain*D$vis)
f <- update(f, .~. +D$rain*D$vis)
Anova(f)
summary(fit)
# Adding clima to the party
# with a maximum model
update(fit,.~. + D^2)
# Adding clima to the party
# with a maximum model
D
fit
update(fit, .~. + D$vis*D$rain*D$fog)
Anova(update(fit, .~. + D$vis*D$rain*D$fog))
plot(D$cond, D$vis)
plot(D$cond, D$vis)
plot(D$cond, D$vis)
par(mfrow=c(1,1))
plot(D$cond, D$vis)
lm(vis ~ cond + fog +cond,D)
Anova(lm(vis ~ cond + fog +cond,D))
Anova(lm(vis ~ cond + fog + rain,D))
# Adding clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","fog","rain","cond"))
fit_scope <- lm(.~.,D_scope)
str(D)
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = .^3, k=log(nrow(D_scope)), test = "F")
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
# Adding clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","fog","rain","cond","dag"))
# Vi tager vis med da den er resultat af cond,fog og rain
par(mfrow=c(1,1))
Anova(lm(vis ~ cond + fog + rain,D))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
Anova(fit)
summary(new_fit)
Anova(fit)
Anova(new_fit)
alias(new_fit)
Anova(new_fit)
drop1(new_fit)
update(.~.-,new_fit)
drop1(new_fit)
Anova(lm(vis ~ cond + fog + rain,D))
summary(new_fit, correlation = T)
# Adding clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","fog","rain","cond","dag", "vis", "dew_pt"))
# Vi tager vis med da den er resultat af cond,fog og rain
par(mfrow=c(1,1))
Anova(lm(vis ~ cond + fog + rain,D))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
# Adding clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","fog","rain","cond","dag", "vis", "dew_pt"))
# Vi tager vis med da den er resultat af cond,fog og rain
par(mfrow=c(1,1))
Anova(lm(vis ~ cond + fog + rain,D))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
Anova(new_fit)
plot(D$hum,D$tempdif)
alias(new_fit)
Anova(new_fit)
# Adding clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","fog","rain","cond","dag", "vis", "dew_pt","dir"))
# Vi tager vis med da den er resultat af cond,fog og rain
par(mfrow=c(1,1))
Anova(lm(vis ~ cond + fog + rain,D))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
Anova(new_fit)
summary(new_fit)
Anova(new_fit)
str(D)
Anova(new_fit)
# Makes no sense
update(new_fit, .~. -hum:start_or_end)
# Makes no sense
new_fit <- update(new_fit, .~. -hum:start_or_end)
Anova(new_fit)
new_fit <- update(new_fit, .~. -tempdif:start_or_end )
Anova(new_fit)
par(mfrow=c(1,1))
Anova(lm(vis ~ cond + fog + rain,D))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^3 , k=log(nrow(D_scope)), test = "F")
Anova(new_fit, fit)
anova(new_fit, fit)
fit
AIC(fit, new_fit)
anova(new_fit, fit)
# Makes no sense (but is significant)
f1 <- update(new_fit, .~. -hum:start_or_end)
Anova(new_fit)
f2 <- update(new_fit, .~. -tempdif:start_or_end )
Anova(new_fit)
anova(f2, new_fit)
AIC(newfit, f2)
AIC(new_fit, f2)
AIC(new_fit, f2)
AIC(new_fit, f1)
Anova(new_fit)
fit
update(fit, .~. + D$hum)
Anova(update(fit, .~. + D$hum))
step(Anova(update(fit, .~. + D$hum)), test ="F")
x <- step(update(fit, .~. + D$hum))
x <- step(update(fit, .~. + D$hum), test ="F")
Anova(x)
anova(x, fit)
AIC(x, fit)
x <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F")
AIC(x, fit)
Anova(x)
# adding some clima
fit_clima <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F")
anova(fit_clima, fit)
AIC(fit_clima, fit)
Anova(fit_clima)
drop1(fit_clima)
drop1(fit_clima)
plot(fit_clima)
Anova(fit_clima)
Anova(fit_clima)
#### Introduction ####
rm(list=ls())
library(tidyverse)
library(ggplot2)
library(car)
library(stringr)
library(xtable)
#### Loading the data ####
D <- read.csv("merged_data.csv", header=TRUE)
#### Changing the datatable #####
str(D)
D <- mutate(D,
across(c(dir, cond, fog, rain, ID),factor)
)
D$date <- as.POSIXct(D$date, tz = "UTC")
str(D)
# Adding to temp difference column to the dataframe
D$tempdif <- 21 - D$temp
#### Creating initalizing plots ####
# Pairplot of all variables
#plot(D,col=D$ID,main="Pairsplot of dataframe")
# Histogram of consumptions in general
hist(D$consumption,col=D$ID)
par(mfrow=c(1,1))
# Consumption as a function of temp ( slopes seem to depend on Ua (isolation))
#plot(D$consumption ~ D$temp, col=D$ID, main = "Consumption as a function of tempature")
plot(D$consumption ~ D$tempdif, col=D$ID, main = "Consumption as a function of tempaturedifference")
plot(D$consumption ~ D$date, ylim=c(0,2), col=D$ID)
plot(D$tempdif ~ D$date)
plot(D$consumption ~ D$date, col=D$ID)
ggplot(D,aes(x=date, y=consumption,col=ID)) +
geom_point(size=0.8) + theme(legend.position = "none")
# shows date needs to be factorized in some sort of way
# Consumption as a function of hum
#plot(D$consumption ~ D$hum, col=D$ID, main = "Consumption as a function of humidity")
# Box plot af consumption as a function of ID
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID")
#plot(D$consumption ~ D$ID, col=D$ID, main="Boxplot of consumption as a function of ID",ylim=c(0,1))
D <- select(D,!c("temp"))
# getting start/end_date int (mutating the date variable)
date <- mutate(D, dag=str_split_fixed(date,"-",3)[ ,3])
date <- mutate(date, start_or_end = ifelse(as.integer(dag)<15, "START","END")) %>%
mutate(start_or_end = factor(start_or_end))
# Trying one fit
#it <- lm(consumption~tempdif+ID+tempdif:start_or_end,date)
#Anova(fit)
#coplot(consumption ~ tempdif | start_or_end,date,col=date$ID)
# And another
#fit <- lm(consumption~tempdif+ID+tempdif:start_or_end +ID:tempdif:start_or_end,date)
#par(mfrow=c(2,2))
#plot(fit)
# Minimum model
mean_cons<- mean(D$consumption)
D <- mutate(date, std_cons=consumption/mean_cons)
D_no_clima <- select(D, ID,start_or_end, tempdif, std_cons)
fit <- lm(std_cons ~ .^4, D_no_clima)
drop1(fit,test="F")
new_fit <- step(fit, test="F",correlation = TRUE)
Anova(new_fit,correlation=TRUE)
drop1(new_fit)
# Looking for outliers
par(mfrow=c(2,2))
plot(new_fit)
# Removing outliers
remove <- c(3357,3282,3440)
D <- D[!(row.names(D) %in% remove ),]
D_no_clima<- D_no_clima[!(row.names(D_no_clima) %in% remove),]
fit <- lm(std_cons ~ (ID + start_or_end + tempdif)^4, D_no_clima)
par(mfrow=c(2,2))
plot(fit)
summary(fit)
# adding some clima
fit_clima <- step(update(fit, .~. + D$hum*D$wind_spd), test ="F")
anova(fit_clima, fit) # They are sig dif
AIC(fit_clima, fit) # fit_clima er bedre
Anova(fit_clima)
plot(fit_clima)
# Adding MORE lima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","dag"))
# Vi tager vis med da den er resultat af cond,fog og rain
par(mfrow=c(1,1))
# Adding MORE clima to the party
# with a maximum model
D_scope <- select(D, !c("date", "consumption","dag"))
fit_scope <- lm(std_cons~. ,D_scope)
new_fit <- step(fit_scope, scope = ~.^4 , k=log(nrow(D_scope)), test = "F")
new_fit
summary(new_fit)
Anova(new_fit)
alias(new_fit)
